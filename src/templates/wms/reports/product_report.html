{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h4 class="mb-4">üì¶ –ó–≤—ñ—Ç –ø–æ —Ç–æ–≤–∞—Ä–∞—Ö</h4>

  <!-- –§—ñ–ª—å—Ç—Ä–∏ -->
  <form method="get" class="row align-items-end g-3 mb-4">
    <div class="col-md-3">
      <label for="date_from" class="form-label">–î–∞—Ç–∞ –≤—ñ–¥</label>
      <input type="date" name="date_from" id="date_from" value="{{ date_from }}" class="form-control">
    </div>
    <div class="col-md-3">
      <label for="date_to" class="form-label">–î–∞—Ç–∞ –¥–æ</label>
      <input type="date" name="date_to" id="date_to" value="{{ date_to }}" class="form-control">
    </div>
    <div class="col-md-3 d-flex gap-2">
      <button type="submit" class="btn btn-primary w-100">üîç –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
    </div>
    <div class="col-md-3 d-flex flex-column gap-2">
      <a href="?export=excel&date_from={{ date_from }}&date_to={{ date_to }}" class="btn btn-success w-100">‚¨áÔ∏è –ï–∫—Å–ø–æ—Ä—Ç Excel</a>
      <a href="?export=pdf&date_from={{ date_from }}&date_to={{ date_to }}" class="btn btn-danger w-100">‚¨áÔ∏è –ï–∫—Å–ø–æ—Ä—Ç PDF</a>
    </div>
  </form>

  <hr>

  <!-- –¢–∞–±–ª–∏—Ü—è -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>–ù–∞–∑–≤–∞</th>
          <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
          <th>–¶—ñ–Ω–∞</th>
          <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
          <th>–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è</th>
        </tr>
      </thead>
      <tbody>
        {% for p in products %}
        <tr>
          <td>{{ p.name }}</td>
          <td>{{ p.category.name|default:"-" }}</td>
          <td>{{ p.selling_price|floatformat:2 }}</td>
          <td>{{ p.quantity|floatformat:0 }}</td>
          <td>{{ p.created_at|date:"Y-m-d" }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5">–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è -->
  {% if is_paginated %}
  <nav class="d-flex justify-content-center mt-4">
    <ul class="pagination">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}&date_from={{ date_from }}&date_to={{ date_to }}">¬´</a>
        </li>
      {% endif %}
      {% for num in paginator.page_range %}
        <li class="page-item {% if page_obj.number == num %}active{% endif %}">
          <a class="page-link" href="?page={{ num }}&date_from={{ date_from }}&date_to={{ date_to }}">{{ num }}</a>
        </li>
      {% endfor %}
      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}&date_from={{ date_from }}&date_to={{ date_to }}">¬ª</a>
        </li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
</div>
{% endblock %}
